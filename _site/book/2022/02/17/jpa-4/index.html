<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
<meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
<meta http-equiv='X-UA-Compatible' content='IE=edge'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>


<meta name="description" content="✓︎ @Entity
✓︎ @Table
✓︎ 데이터베이스 스키마 자동 생성
✓︎ DDL 생성 기능
✓︎ 기본 키 매핑
✓︎ 필드와 컬럼 매핑: 레퍼런스
" />
<meta property="og:description" content="✓︎ @Entity
✓︎ @Table
✓︎ 데이터베이스 스키마 자동 생성
✓︎ DDL 생성 기능
✓︎ 기본 키 매핑
✓︎ 필드와 컬럼 매핑: 레퍼런스
" />

<meta name="author" content="Chloe" />


<meta property="og:title" content="자바 ORM 표준 JPA 프로그래밍 - (4) 엔티티 매핑" />
<meta property="twitter:title" content="자바 ORM 표준 JPA 프로그래밍 - (4) 엔티티 매핑" />



    <title>자바 ORM 표준 JPA 프로그래밍 - (4) 엔티티 매핑 – Chloe – 조금씩, 천천히, 꾸준히</title>

    <link rel="stylesheet" type="text/css" href="/style.css"/>
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/ress/dist/ress.min.css"/>
    <link rel="shortcut icon" type="image/x-icon" href="/assets/image/favicon.ico">
    <link rel="icon" type="image/x-icon" href="/assets/image/favicon.ico">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-config" content="/assets/image/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <link rel="alternate" type="application/rss+xml" title="Chloe - 조금씩, 천천히, 꾸준히" href="/feed.xml"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css" integrity="sha256-XoaMnoYC5TH6/+ihMEnospgm0J1PM/nioxbOUdnM8HY=" crossorigin="anonymous" media="print" onload="this.media='all'"/>
    <link rel="stylesheet" href="https://cdn.plyr.io/3.6.5/plyr.css" media="print" onload="this.media='all'"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" media="print" onload="this.media='all'"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css" integrity="sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET" crossorigin="anonymous" media="print" onload="this.media='all'"/>

  </head>

  <body>
    </div>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="/assets/image/avatar.png" width="70" height="70" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">Chloe</a></h1>
            <p class="site-description">조금씩, 천천히, 꾸준히</p>
          </div>

          <nav class="nav-menu">
            
  <a class="nav-menu-item"<a href="/">Blog</a>

  <a class="nav-menu-item"<a href="/tags">Tag</a>

  <a class="nav-menu-item"<a href="/about">About</a>

  <a class="nav-menu-item"<a href="/search">Search</a>


          </nav>
        </header>
      </div>
    </div>

    <div class="post-container">
      <div id="category" class="category">
        <aside>
          
          
            
              
            
          
            
              
              <a class="category-link " href="/category/Book/">
                <i class="fa fa-tags fa-fw" aria-hidden="true"></i>&nbspBook
              </a>
              
            
          
            
              
              <a class="category-link " href="/category/Daily/">
                <i class="fa fa-tags fa-fw" aria-hidden="true"></i>&nbspDaily
              </a>
              
            
          
            
              
              <a class="category-link " href="/category/Programming/">
                <i class="fa fa-tags fa-fw" aria-hidden="true"></i>&nbspProgramming
              </a>
              
            
          
            
          
            
              
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
        </aside>
      </div>
      <div id="main" role="main" class="content">
        <article class="post">
  <div class="post-title">

    <p class="title">자바 ORM 표준 JPA 프로그래밍 - (4) 엔티티 매핑</p>

    <div class="post-option">
      <!--<div class="post-categories">
        <i class="fa fa-tags fa-fw" aria-hidden="true"></i>&nbsp;Tags:&nbsp;
        
        
        <a class="categories-button"<a href="/categories/#Book">Book</a>
        
        
      </div>-->
      <div class="date">
        <i class="fa fa-calendar fa-fw" aria-hidden="true"></i>&nbsp;Date: 2022-02-17
      </div>
    </div>
  </div>

  <div class="entry">
    <p class="notice-list"><a href="#1-entity">✓︎ @Entity</a><br />
<a href="#2-table">✓︎ @Table</a><br />
<a href="#4-데이터베이스-스키마-자동-생성">✓︎ 데이터베이스 스키마 자동 생성</a><br />
<a href="#5-ddl-생성-기능">✓︎ DDL 생성 기능</a><br />
<a href="#6-기본-키-매핑">✓︎ 기본 키 매핑</a><br />
<a href="#7-필드와-컬럼-매핑-레퍼런스">✓︎ 필드와 컬럼 매핑: 레퍼런스</a></p>

<h3 id="1-entity">1. @Entity</h3>

<ul>
  <li>JPA를 사용해서 테이블과 매핑할 클래스는 <code class="language-plaintext highlighter-rouge">@Entity</code> 어노테이션을 붙여야 한다.</li>
  <li>주의사항
    <ul>
      <li>기본 생성자는 필수로 있어야 한다.</li>
      <li><code class="language-plaintext highlighter-rouge">final 클래스</code>, <code class="language-plaintext highlighter-rouge">enum</code>, <code class="language-plaintext highlighter-rouge">interface</code>, <code class="language-plaintext highlighter-rouge">inner 클래스</code>에는 사용할 수 없다.</li>
      <li>저장할 필드에 <code class="language-plaintext highlighter-rouge">final</code>을 사용하면 안 된다.</li>
    </ul>
  </li>
</ul>

<h3 id="2-table">2. @Table</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">@Table</code> 은 엔티티와 매핑할 테이블을 지정한다. 생략하면, 매핑한 엔티티 이름을 테이블 이름으로 사용한다.</li>
</ul>

<h3 id="3-다양한-매핑-사용">3. 다양한 매핑 사용</h3>
<ul>
  <li><strong class="bg-lg outline">예제 코드</strong>
- <a href="https://github.com/pageprologue/jpa-book/blob/main/chapter4/src/main/java/study/Member.java">회원 엔티티에 다양한 매핑 적용</a></li>
  <li>컬럼 매핑에 대한 설명은 아래에서 추가 설명 <a href="#7-필드와-컬럼-매핑-레퍼런스" class="case-link">필드와 컬럼 매핑: 레퍼런스</a></li>
</ul>

<h3 id="4-데이터베이스-스키마-자동-생성">4. 데이터베이스 스키마 자동 생성</h3>

<ul>
  <li>JPA는 데이터베이스 스키마를 자동으로 생성하는 기능을 지원한다.</li>
  <li>
    <p>persistence.xml 에 속성을 추가하여 <code class="language-plaintext highlighter-rouge">create</code>, <code class="language-plaintext highlighter-rouge">create-drop</code>, <code class="language-plaintext highlighter-rouge">update</code>, <code class="language-plaintext highlighter-rouge">validate</code>, <code class="language-plaintext highlighter-rouge">none</code> 으로 스키마 생성을 설정할 수 있다.</p>

    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"hibernate.show_sql.auto"</span> <span class="na">value=</span><span class="s">"create"</span><span class="nt">&gt;</span>
</code></pre></div>    </div>
  </li>
</ul>

<p class="notice-danger">운영 서버에서는 create, create-drop, update 처럼 DLL 을 수정하는 옵션은 절대 사용하면 안된다. 이 옵션들은 운영중인 데이터베이스의 테이블이나 컬럼을 삭제할 수 있다.</p>

<h3 id="5-ddl-생성-기능">5. DDL 생성 기능</h3>

<ul>
  <li>DDL 생성 기능은 DDL을 자동 생성할 때만 사용되고, JPA의 실행 로직에는 영향을 주지 않는다.</li>
  <li>DDL 생성 기능 사용 예시
    <ul>
      <li><code class="language-plaintext highlighter-rouge">@Column</code>의 <code class="language-plaintext highlighter-rouge">nullable</code> 속성으로 not null 제약조건을 추가할 수 있다.</li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">@Column</code>의 <code class="language-plaintext highlighter-rouge">length</code> 속성으로 문자의 크기를 지정할 수 있다.</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"NAME"</span><span class="o">,</span> <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">10</span><span class="o">)</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">userName</span><span class="o">;</span>
</code></pre></div>        </div>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">@Table</code>의 <code class="language-plaintext highlighter-rouge">@UniqueConstraint</code> 속성으로 유니크 제약조건을 추가할 수 있다.</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER"</span><span class="o">,</span> <span class="n">uniqueConstraints</span> <span class="o">=</span> <span class="o">{</span><span class="nd">@UniqueConstraint</span><span class="o">(</span>
          <span class="n">name</span> <span class="o">=</span> <span class="s">"NAME_AGE_UNIQUE"</span><span class="o">,</span>
          <span class="n">columnNames</span> <span class="o">=</span> <span class="o">{</span><span class="s">"NAME"</span><span class="o">,</span> <span class="s">"AGE"</span><span class="o">})})</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>이런 기능을 사용하면 애플리케이션 개발자가 엔티티만 보고도 손쉽게 다양한 제약 조건을 파악할 수 있는 장점이 있다.</li>
</ul>

<h3 id="6-기본-키-매핑">6. 기본 키 매핑</h3>

<ul>
  <li>기본키를 애플리케이션에서 직접 할당하는 대신에 데이터베이스가 생성해주는 값을 사용할 수도 있다.</li>
  <li>JPA가 제공하는 데이터베이스 기본 키 생성 전략은 다음과 같다.
    <ul>
      <li>직접 할당 : 기본 키 생성을 데이터베이스에 위임한다.</li>
      <li>자동 생성</li>
      <li><strong class="bg-sky outline">IDENTITY</strong> : 기본 키 생성을 데이터베이스에 위임한다.</li>
      <li><strong class="bg-sky outline">SEQUENCE</strong> : 데이터베이스 시퀀스를 사용해서 기본 키를 할당한다.</li>
      <li><strong class="bg-sky outline">TABLE</strong> : 키 생성 테이블을 사용한다.</li>
    </ul>
  </li>
  <li>자동 생성 전략이 다양한 이유는 데이터베이스 벤더마다 지원하는 방식이 다르기 때문이다.</li>
  <li>
    <p>키 생성 전략을 사용하려면 persistence.xml에 설정을 추가해야 한다.</p>

    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"hibernate.id.new_generator_mappings"</span> <span class="na">value=</span><span class="s">"true"</span><span class="nt">&gt;</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="1-기본키-직접-할당-전략">1) 기본키 직접 할당 전략</h4>

<ul>
  <li>기본 키를 직접 할당하려면 <code class="language-plaintext highlighter-rouge">@Id</code> 로 매핑하면 된다.</li>
  <li><code class="language-plaintext highlighter-rouge">em.persist()</code> 로 엔티티를 저장하기 전에 애플리케이션에서 기본 키를 직접 할당하는 방법이다.</li>
  <li class="blank"></li>
</ul>

<h4 id="2-identity-전략">2) IDENTITY 전략</h4>

<ul>
  <li>IDENTITY는 기본 키 생성을 데이터베이스에 위임하는 전략이다.</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">@GeneratedValue</code> 어노테이션의 strategy 속성을 <code class="language-plaintext highlighter-rouge">GenerationType.IDENTITY</code> 로 설정한다.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Entity</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Board</span> <span class="o">{</span>
      <span class="nd">@Id</span>
      <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
      <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
  <span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>IDENTITY 전략은 데이터베이스에 값을 저장하고 나서야 기본 키 값을 구할 수 있을 때 사용한다.
    <ul>
      <li>IDENTITY 전략은 데이터를 데이터베이스에 <code class="language-plaintext highlighter-rouge">INSERT</code> 한 후에 기본 키 값을 조회할 수 있다.</li>
      <li>JDBC3에 추가된 <code class="language-plaintext highlighter-rouge">Statement.getGeneratedKeys()</code>를 사용하면 데이터를 저장하면서 동시에 생성된 기본 키 값도 얻어 올 수 있다. 하이버네이트는 이 메소드를 사용해서 데이터베이스와 한 번만 통신한다.</li>
    </ul>
  </li>
  <li>엔티티가 영속 상태가 되려면 식별자가 반드시 필요하다.
    <ul>
      <li>따라서 이 전략은 트랜잭션을 지원하는 쓰기 지연이 동작하지 않는다.</li>
    </ul>
  </li>
  <li class="blank"></li>
</ul>

<h4 id="3-sequence-전략">3) SEQUENCE 전략</h4>

<ul>
  <li>SEQUENCE 전략은 시퀀스를 사용해서 기본 키를 생성한다.</li>
  <li><code class="language-plaintext highlighter-rouge">@SequenceGenerator</code>를 사용해서 시퀀스 생성기를 등록한다.</li>
  <li>시퀀스 생성기를 실제 데이터베이스의 시퀀스와 매핑한다.</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">@GeneratedValue</code> 어노테이션의 strategy 속성을 <code class="language-plaintext highlighter-rouge">GenerationType.SEQUENCE</code> 로 설정한다.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Entity</span>
  <span class="nd">@SequenceGenerator</span><span class="o">(</span>
      <span class="n">name</span> <span class="o">=</span> <span class="s">"BOARD_SEQ_GENERATOR"</span><span class="o">,</span>
      <span class="n">sequenceName</span> <span class="o">=</span> <span class="s">"BOARD_SEQ"</span><span class="o">,</span>
      <span class="n">initialValue</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">allocationSize</span> <span class="o">=</span> <span class="mi">1</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Board</span> <span class="o">{</span>
      <span class="nd">@Id</span>
      <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">SEQUENCE</span><span class="o">,</span>
                                      <span class="n">generator</span> <span class="o">=</span> <span class="s">"BOARD_SEQ_GENERATOR"</span><span class="o">)</span>
      <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
  <span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>SEQUENCE 전략은 <code class="language-plaintext highlighter-rouge">em.persist()</code>를 호출할 때 먼저 데이터베이스의 시퀀스를 사용해서 식별자를 조회한다.</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">@SequenceGenerator</code> 속성</p>

    <p><img src="https://media.vlpt.us/images/tjeong/post/45d72993-e53b-42b7-9c5a-c926c15348e1/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202021-07-20%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%203.49.22.png" alt="" class="center" width="80%" /></p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">SequenceGenerator.allocationSize</code> 의 기본 값이 50인 것에 주의해야 한다. 데이터베이스 시퀀스 값이 하나씩 증가하도록 설정되어 있으면 이 값을 반드시 1로 설정해야 한다.</li>
      <li class="blank"></li>
    </ul>
  </li>
</ul>

<h4 id="4-table-전략">4) TABLE 전략</h4>

<ul>
  <li>TABLE 전략은 키 생성 전용 테이블을 하나 만들고 여기에 이름과 값으로 사용할 컬럼을 만들어 데이터베이스 시퀀스를 흉내내는 전략이다.</li>
  <li><code class="language-plaintext highlighter-rouge">@TableGenerator</code>를 사용해서 테이블 키 생성기를 등록한다.</li>
  <li>테이블 생성기를 실제 데이터베이스의 테이블과 매핑한다.</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">@GeneratedValue</code> 어노테이션의 strategy 속성을 <code class="language-plaintext highlighter-rouge">GenerationType.TABLE</code> 로 설정한다.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@TableGenerator</span><span class="o">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"BOARD_SEQ_GENERATOR"</span><span class="o">,</span>
    <span class="n">table</span> <span class="o">=</span> <span class="s">"MY_SEQUENCE"</span><span class="o">,</span>
    <span class="n">pkColumnValue</span> <span class="o">=</span> <span class="s">"BOARD_SEQ"</span><span class="o">,</span> <span class="n">allocationSize</span> <span class="o">=</span> <span class="mi">1</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Board</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">TABLE</span><span class="o">,</span>
                                    <span class="n">generator</span> <span class="o">=</span> <span class="s">"BOARD_SEQ_GENERATOR"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>TABLE 생성 전략은 시퀀스 대신에 테이블을 사용한다는 것만 제외하면 SEQUENCE 전략과 내부 동작 방식이 같다.</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">@TableGenerator</code> 속성</p>

    <p><img src="https://media.vlpt.us/images/tjeong/post/a7902f7b-3ca0-4ae8-993f-1a2e956eb65a/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202021-07-20%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%203.48.34.png" alt="" class="center" width="80%" /></p>
  </li>
  <li>TABLE 전략은 값을 조회하면서 <code class="language-plaintext highlighter-rouge">SELECT</code> 쿼리를 사용하고 다음 값으로 증가시키기 위해 <code class="language-plaintext highlighter-rouge">UPDATE</code> 쿼리를 사용한다. 이 전략은 SEQUENCE 전략과 비교해서 데이터베이스와 한 번 더 통신하는 단점이 있다. TABLE 전략을 최적화하려면 <code class="language-plaintext highlighter-rouge">@TableGenerator.allocationSize</code>를 사용하면 된다.</li>
  <li class="blank"></li>
</ul>

<h4 id="5-auto-전략">5) AUTO 전략</h4>

<ul>
  <li>AUTO 전략은 데이터베이스 방언에 따라 IDENTITY, SEQUENCE, TABLE 전략 중 하나를 자동으로 선택한다.
    <ul>
      <li>예를 들어, 오라클을 선택하면 SEQUENCE, MySQL을 선택하면 IDENTITY 전략을 자동으로 선택한다.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">@GeneratedValue</code> 어노테이션의 strategy 속성을 <code class="language-plaintext highlighter-rouge">GenerationType.AUTO</code> 로 설정한다.</li>
  <li>키 생성 전략이 아직 확정되지 않은 개발 초기 단계나 프로토타입 개발 시 편리하게 사용할 수 있다.</li>
  <li>AUTO를 사용할 때 SEQUENCE 나 TABLE 전략이 선택되면 키 생성용 테이블을 미리 만들어 두어야 한다. 만약 스키마 자동 생성 기능을 사용한다면 하이버네이트가 기본값을 사용해서 적절한 시퀀스나 키 생성용 테이블을 만들어 줄 것이다.</li>
</ul>

<p class="notice-basic">JPA는 모든 엔티티에 일관된 방식으로 <strong>대리 키</strong> 사용을 권장한다.</p>

<h3 id="7-필드와-컬럼-매핑-레퍼런스">7. 필드와 컬럼 매핑: 레퍼런스</h3>

<p><img src="https://lh3.googleusercontent.com/pw/ACtC-3dxhFfiOZAMlGQUgCDr-N8Xjj9bhW1k_06o5kQihb6Cr30BvzVeAn9cbLfXVKCMcB7Fn2CADmOLeS_GAAIs0JTinqCRY8n6yu0HEqMilP0F-wPIhN2FOLcJOUt_EDNqOHK_tPsIMiKASj3FAZYvvnQveg=w560-h234-no?authuser=0" alt="" class="center" width="80%" /></p>

<h4 id="column">@Column</h4>

<ul>
  <li>@Column은 객체 필드를 테이블 컬럼에 매핑한다.</li>
  <li><code class="language-plaintext highlighter-rouge">name</code>, <code class="language-plaintext highlighter-rouge">nullable</code> 이 주로 사용된다.</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">nullable</code> 의 기본값이 true 이므로, 자바 기본 타입 사용시 @Column을 사용할 경우 <code class="language-plaintext highlighter-rouge">nullable = false</code>로 지정해 주어야 한다. 또는, @Column을 생략하면 자바 기본 타입일 경우 자동으로 not null 로 생성된다.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kt">int</span> <span class="n">data1</span><span class="o">;</span> <span class="c1">//@Column 생략, 자바 기본타입</span>
  <span class="cm">/* 생성된 DDL : data1 integer not null */</span>
    
  <span class="nc">Integer</span> <span class="n">data2</span><span class="o">;</span> <span class="c1">//@Column 생략, 객체 타입</span>
  <span class="cm">/* 생성된 DDL : data2 integer */</span>
    
  <span class="nd">@Column</span>
  <span class="kt">int</span> <span class="n">data3</span><span class="o">;</span> <span class="c1">//@Column 사용, 자바 기본타입</span>
  <span class="cm">/* 생성된 DDL : data3 integer */</span>
</code></pre></div>    </div>

    <p><img src="https://lh3.googleusercontent.com/pw/ACtC-3dTFygHCyeuoKvMJ-E0Amg7HOPtMg3Bd9nH2-tu5-CrqD8hE5vY3l3wHJXafo4VwViZMJ1PVLQQXX-qGc64XEToVsH2EWaCd5RgPYCRHGYYNUZgDwV4A_cc8wf0fS-nlTYMWqT0NcZIrdFz0Atv1hOvkQ=w682-h507-no?authuser=0" alt="" class="center" width="90%" /></p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Colum</span><span class="o">(</span>
    <span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> 
    <span class="n">unique</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span>
    <span class="n">columnDefinition</span> <span class="o">=</span> <span class="s">"varchar(100) default 'EMPTY'"</span><span class="o">,</span>
    <span class="n">length</span> <span class="o">=</span> <span class="mi">100</span>
<span class="o">)</span>
<span class="kd">private</span> <span class="nc">String</span> <span class="n">registrationNumber</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="enumerated">@Enumerated</h4>

<ul>
  <li>자바의 enum 타입을 매핑할 대 사용한다.</li>
  <li><code class="language-plaintext highlighter-rouge">EnumType.ORDINAL</code>은 enum 에 정의된 순서대로 ADMIN 은 0, USER 는 1 값이 데이터베이스에 저장된다.
    <ul>
      <li>장점 : 저장되는 데이터 크기가 작아진다.</li>
      <li>단점 : 이미 저장이 되었다면 enum 의 순서를 변경하면 안된다.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">EnumType.STRING</code> 은 enum 이름 그래도 ADMIN은 ‘ADMIN’, USER는 ‘USER’라는 문자로 데이터베이스에 저장된다. (권장)
    <ul>
      <li>장점 : 저장된 enum 의 순서가 바뀌거나 enum이 추가되어도 안전하다.</li>
      <li>단점 : 저장되는 데이터 크기가 크다.</li>
    </ul>
  </li>
</ul>

<h4 id="temporal">@Temporal</h4>

<ul>
  <li>날짜 타입(<code class="language-plaintext highlighter-rouge">java.util.Date</code>, <code class="language-plaintext highlighter-rouge">java.util.Calendar</code>)을 매핑할 때 사용한다. 하지만 날짜 및 시간을 다룰 때 이 타입들이 잘 사용되지 않는다.</li>
  <li>
    <p>Java 8은 <code class="language-plaintext highlighter-rouge">java.time</code> 패키지 를 도입했으며 JDBC 4.2 API는 추가 SQL 유형 <code class="language-plaintext highlighter-rouge">TIMESTAMP WITH TIME ZONE</code> 및 <code class="language-plaintext highlighter-rouge">TIME WITH TIME ZONE</code>을 지원한다. 또한, <code class="language-plaintext highlighter-rouge">OffsetTime</code> 및 <code class="language-plaintext highlighter-rouge">OffsetDateTime</code> 클래스를 통해 UTC에 대한 오프셋 로컬 시간대를 지원한다.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"local_time"</span><span class="o">,</span> <span class="n">columnDefinition</span> <span class="o">=</span> <span class="s">"TIME"</span><span class="o">)</span>
  <span class="kd">private</span> <span class="nc">LocalTime</span> <span class="n">localTime</span><span class="o">;</span>
    
  <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"local_date"</span><span class="o">,</span> <span class="n">columnDefinition</span> <span class="o">=</span> <span class="s">"DATE"</span><span class="o">)</span>
  <span class="kd">private</span> <span class="nc">LocalDate</span> <span class="n">localDate</span><span class="o">;</span>
    
  <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"local_date_time"</span><span class="o">,</span> <span class="n">columnDefinition</span> <span class="o">=</span> <span class="s">"TIMESTAMP"</span><span class="o">)</span>
  <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">localDateTime</span><span class="o">;</span>
    
  <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"offset_time"</span><span class="o">,</span> <span class="n">columnDefinition</span> <span class="o">=</span> <span class="s">"TIME WITH TIME ZONE"</span><span class="o">)</span>
  <span class="kd">private</span> <span class="nc">OffsetTime</span> <span class="n">offsetTime</span><span class="o">;</span>
    
  <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"offset_date_time"</span><span class="o">,</span> <span class="n">columnDefinition</span> <span class="o">=</span> <span class="s">"TIMESTAMP WITH TIME ZONE"</span><span class="o">)</span>
  <span class="kd">private</span> <span class="nc">OffsetDateTime</span> <span class="n">offsetDateTime</span><span class="o">;</span>
</code></pre></div>    </div>

    <p><img src="/image/jpa/jpa-4-1.png" alt="" class="center" /></p>
  </li>
  <li class="blank half"></li>
</ul>

<h4 id="lob">@Lob</h4>

<ul>
  <li>데이터베이스 BLOL, CLOB 타입과 매핑한다.</li>
</ul>

<h4 id="transient">@Transient</h4>

<ul>
  <li>이 필드는 매핑하지 않고, 객체에 임시로 어떤 값을 보관하고 싶을 때 사용한다.</li>
</ul>

<h4 id="access">@Access</h4>

<ul>
  <li><code class="language-plaintext highlighter-rouge">AccessType.FIELD</code>
    <ul>
      <li>필드 접근 권한이 private 이어도 필드에 직접 접근할 수 있다.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">AccessType.PROPERTY</code>
    <ul>
      <li>접근자(getter)를 사용한다.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">@Access</code>를 설정하지 않으면 @Id 의 위치를 기준으로 접근 방식이 설정된다.</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">@Id</code>가 필드에 있으므로 <code class="language-plaintext highlighter-rouge">@Access(AccessType.FIELD)</code>로 설정한 것과 같다. 따라서 @Access 는 생략 가능하다.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Entity</span>
  <span class="nd">@Access</span><span class="o">(</span><span class="nc">AccessType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
      <span class="nd">@Id</span>
      <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
  <span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">@Id</code>가 프로퍼티에에 있으므로 <code class="language-plaintext highlighter-rouge">@Access(AccessType.PROPERTY)</code>로 설정한 것과 같다. 따라서 @Access 는 생략 가능하다.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Entity</span>
  <span class="nd">@Access</span><span class="o">(</span><span class="nc">AccessType</span><span class="o">.</span><span class="na">PROPERTY</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    
      <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
    
      <span class="kd">private</span> <span class="nc">String</span> <span class="n">data1</span><span class="o">;</span>
    
      <span class="nd">@Id</span>
      <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
      <span class="o">}</span>
    
      <span class="nd">@Column</span>
      <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getData1</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">return</span> <span class="n">data1</span><span class="o">;</span>
      <span class="o">}</span>
  <span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>필드 접근 방식과 프로퍼티 접근 방식을 함께 사용할 수도 있다.
    <ul>
      <li>
        <p>회원 엔티티를 저장하면 회원 테이블 FULLNAME 컬럼에 firstName + lastName 결과과 저장된다.</p>

        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
    
    <span class="nd">@Transient</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">firstName</span><span class="o">;</span>
    
    <span class="nd">@Transient</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">lastName</span><span class="o">;</span>
    
    <span class="nd">@Access</span><span class="o">(</span><span class="nc">AccessType</span><span class="o">.</span><span class="na">PROPERTY</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getFullName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">firstName</span> <span class="o">+</span> <span class="n">lastName</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>

<p><br /></p>

<div class="post-reference">
   <p>Reference</p>
   <a href="https://velog.io/@tjeong/JPA-%EC%97%94%ED%8B%B0%ED%8B%B0-%EB%A7%A4%ED%95%91-%EA%B3%B5%EB%B6%80%EC%9D%98-%EA%B8%B0%EB%A1%9D">JJPA 엔티티 매핑 공부의 기록</a>
   <a href="https://demoversion.tistory.com/96">JPA 공부 - 4</a>
</div>

  </div>

</article>

      </div>
    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer"><div class="copyright">
            
            <p>Copyright &copy; 2022 Chloe.</p>
            
          </div>    
        </footer>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/gh/mcstudios/glightbox/dist/js/glightbox.min.js"></script>
    <script type="text/javascript">
      const lightbox = GLightbox({
          touchNavigation: true,
          loop: true,
          autoplayVideos: true
      });
    </script>

    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js" integrity="sha384-GxNFqL3r9uRJQhR+47eDxuPoNE7yLftQM8LcxzgS4HT73tp970WS/wV5p8UzCOmb" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"
            onload="renderMathInElement(document.body,{
                    delimiters: [
                    { left: '$$',  right: '$$',  display: true  },
                    { left: '$',   right: '$',   display: false },
                    { left: '\\[', right: '\\]', display: true  },
                    { left: '\\(', right: '\\)', display: false }
                    ]});">
    </script>
  </body>
</html>
